Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/nbclient/client.py", line 1314, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import os
import warnings

import h5py
import numpy as np
import openpnm as op
import porespy as ps
import scipy as sp
from matplotlib import pyplot as plt
from sklearn.metrics import r2_score

ps.visualization.set_mpl_style()
warnings.filterwarnings("ignore")
path = "./sf-model-lib/diffusion"
path_train = os.path.join(path, 'g_train_original.hdf5')
path_weights = os.path.join(path, 'model_weights.h5')
g_train = h5py.File(path_train, 'r')['g_train'][()]
model = ps.networks.create_model()
model.load_weights(path_weights)
------------------


[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[3], line 18[0m
[1;32m     16[0m path_weights [38;5;241m=[39m os[38;5;241m.[39mpath[38;5;241m.[39mjoin(path, [38;5;124m'[39m[38;5;124mmodel_weights.h5[39m[38;5;124m'[39m)
[1;32m     17[0m g_train [38;5;241m=[39m h5py[38;5;241m.[39mFile(path_train, [38;5;124m'[39m[38;5;124mr[39m[38;5;124m'[39m)[[38;5;124m'[39m[38;5;124mg_train[39m[38;5;124m'[39m][()]
[0;32m---> 18[0m model [38;5;241m=[39m [43mps[49m[38;5;241;43m.[39;49m[43mnetworks[49m[38;5;241;43m.[39;49m[43mcreate_model[49m[43m([49m[43m)[49m
[1;32m     19[0m model[38;5;241m.[39mload_weights(path_weights)

File [0;32m~/work/porespy/porespy/src/porespy/networks/_size_factors.py:614[0m, in [0;36mcreate_model[0;34m()[0m
[1;32m    612[0m [38;5;28;01mfrom[39;00m [38;5;21;01mtensorflow[39;00m[38;5;21;01m.[39;00m[38;5;21;01mkeras[39;00m[38;5;21;01m.[39;00m[38;5;21;01moptimizers[39;00m [38;5;28;01mimport[39;00m Adam
[1;32m    613[0m model [38;5;241m=[39m _resnet3d()
[0;32m--> 614[0m model[38;5;241m.[39mcompile(loss[38;5;241m=[39m[38;5;124m'[39m[38;5;124mmse[39m[38;5;124m'[39m, optimizer[38;5;241m=[39m[43mAdam[49m[43m([49m[43mlr[49m[38;5;241;43m=[39;49m[38;5;241;43m1e-4[39;49m[43m)[49m, metrics[38;5;241m=[39m[[38;5;124m'[39m[38;5;124mmse[39m[38;5;124m'[39m])
[1;32m    615[0m [38;5;28;01mreturn[39;00m model

File [0;32m/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/keras/src/optimizers/adam.py:60[0m, in [0;36mAdam.__init__[0;34m(self, learning_rate, beta_1, beta_2, epsilon, amsgrad, weight_decay, clipnorm, clipvalue, global_clipnorm, use_ema, ema_momentum, ema_overwrite_frequency, name, **kwargs)[0m
[1;32m     43[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m(
[1;32m     44[0m     [38;5;28mself[39m,
[1;32m     45[0m     learning_rate[38;5;241m=[39m[38;5;241m0.001[39m,
[0;32m   (...)[0m
[1;32m     58[0m     [38;5;241m*[39m[38;5;241m*[39mkwargs,
[1;32m     59[0m ):
[0;32m---> 60[0m     [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m
[1;32m     61[0m [43m        [49m[43mlearning_rate[49m[38;5;241;43m=[39;49m[43mlearning_rate[49m[43m,[49m
[1;32m     62[0m [43m        [49m[43mname[49m[38;5;241;43m=[39;49m[43mname[49m[43m,[49m
[1;32m     63[0m [43m        [49m[43mweight_decay[49m[38;5;241;43m=[39;49m[43mweight_decay[49m[43m,[49m
[1;32m     64[0m [43m        [49m[43mclipnorm[49m[38;5;241;43m=[39;49m[43mclipnorm[49m[43m,[49m
[1;32m     65[0m [43m        [49m[43mclipvalue[49m[38;5;241;43m=[39;49m[43mclipvalue[49m[43m,[49m
[1;32m     66[0m [43m        [49m[43mglobal_clipnorm[49m[38;5;241;43m=[39;49m[43mglobal_clipnorm[49m[43m,[49m
[1;32m     67[0m [43m        [49m[43muse_ema[49m[38;5;241;43m=[39;49m[43muse_ema[49m[43m,[49m
[1;32m     68[0m [43m        [49m[43mema_momentum[49m[38;5;241;43m=[39;49m[43mema_momentum[49m[43m,[49m
[1;32m     69[0m [43m        [49m[43mema_overwrite_frequency[49m[38;5;241;43m=[39;49m[43mema_overwrite_frequency[49m[43m,[49m
[1;32m     70[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m     71[0m [43m    [49m[43m)[49m
[1;32m     72[0m     [38;5;28mself[39m[38;5;241m.[39mbeta_1 [38;5;241m=[39m beta_1
[1;32m     73[0m     [38;5;28mself[39m[38;5;241m.[39mbeta_2 [38;5;241m=[39m beta_2

File [0;32m/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/keras/src/backend/tensorflow/optimizer.py:20[0m, in [0;36mTFOptimizer.__init__[0;34m(self, *args, **kwargs)[0m
[1;32m     19[0m [38;5;28;01mdef[39;00m [38;5;21m__init__[39m([38;5;28mself[39m, [38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[0;32m---> 20[0m     [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__init__[39;49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     21[0m     [38;5;28mself[39m[38;5;241m.[39m_distribution_strategy [38;5;241m=[39m tf[38;5;241m.[39mdistribute[38;5;241m.[39mget_strategy()

File [0;32m/opt/hostedtoolcache/Python/3.10.14/x64/lib/python3.10/site-packages/keras/src/optimizers/base_optimizer.py:38[0m, in [0;36mBaseOptimizer.__init__[0;34m(self, learning_rate, weight_decay, clipnorm, clipvalue, global_clipnorm, use_ema, ema_momentum, ema_overwrite_frequency, loss_scale_factor, gradient_accumulation_steps, name, **kwargs)[0m
[1;32m     34[0m     warnings[38;5;241m.[39mwarn(
[1;32m     35[0m         [38;5;124m"[39m[38;5;124mArgument `decay` is no longer supported and will be ignored.[39m[38;5;124m"[39m
[1;32m     36[0m     )
[1;32m     37[0m [38;5;28;01mif[39;00m kwargs:
[0;32m---> 38[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124mf[39m[38;5;124m"[39m[38;5;124mArgument(s) not recognized: [39m[38;5;132;01m{[39;00mkwargs[38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m     40[0m [38;5;28;01mif[39;00m name [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m     41[0m     name [38;5;241m=[39m auto_name([38;5;28mself[39m[38;5;241m.[39m[38;5;18m__class__[39m[38;5;241m.[39m[38;5;18m__name__[39m)

[0;31mValueError[0m: Argument(s) not recognized: {'lr': 0.0001}

